
### [[云上贵州2017]智慧交通预测挑战赛](https://tianchi.aliyun.com/competition/entrance/231598/introduction)
<br/>

这场比赛采用天池特色AB规则，其中A榜大约评测25天，B榜大约评测3天，每天评测1次，最终成绩取A榜和B榜的平均值。<br/><br/>
向官方建议仅取B榜成绩，被无视。最终拿了第四名。<br/><br/>
这场比赛开始的时候要求大家用数加平台，但资源始终紧缺，于是中途修改规则，允许大家线下生成结果。这场比赛之后我就再也没有见过数加。<br/><br/>
我设计了一个略为复杂的规则，也讲过几次，从来没有人耐心听完过。<br/>
简单来说，预测一个时间片的平均通行时间，可以用来参考的当然包括历史每一天同一时段的平均通行时间，和当天早些时候的平均通行时间。所以我的方案要分成两部分，历史预测和近左预测。<br/>
####历史预测<br/>
经过对数据的观察和统计，对赛题的理解和分析，（硬凑排比句的话，对人生的思考和感悟？）我们显然可以发现一个路段在相近的时间的平均通行时间相差较小。例如，一个路段在某一天的8:13和8:15的平均通行时间可能比较接近。因而对于某一路段某一日某一待测时间片，我们用来预测的样本包括历史各日的同一时间片和其附近的（前后三十个）时间片。例如，待测时间片为8:31，则样本为历史各日的8:01、8:03、...、9:01。<br/>
样本的权重，显然应该和它与待测时间片的距离有关，距离越大的，权重应该越小，反之亦然。那么我们可以用距离的倒数作为权重（倒数的平方、四次方也可以试试）；此外，平均通行时间受曜日的影响，因而权重还应该和曜日有关。与待测日同曜日的日子的权重最大，同为工作日或周末的日子的权重要小一些，其馀日子的权重最小，我们将这三种情况的权重分别设为1、0.5和0。将上述两种权重相乘，就得到了的权重。<br/>
用上述所选样本和所计算出的权重，做常数回归，就是历史预测。<br/>
####近左预测<br/>
对于某一路段某一日某一待测时间片，取当日该路段的稍早的数据作为样本，取它们与待测时间起点的距离的倒数作为权重，做常数回归，即为近左预测。（近左这个怪异的名字有些历史原因）<br/>
####融合<br/>
计算出这两种预测之后，就要将它们融合，这里就简单采用加权融合就好。<br/>
但是这里有个问题，每一个路段的权重不一样，有的路段近左预测的权重大一些，有的小一些。我也没找到什么规律，我也不知道这个跟道路的长度和宽度是不是有关系。<br/>
于是我采用了比较粗暴的办法。我把测试集向前移了30天，然后对于每个路段，以0.05为步长，从0遍历到1，看看哪个权重在这30天表现最好，就对这个路段使用这个权重。
